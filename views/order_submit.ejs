<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- External CSS -->
    <link rel="stylesheet" href="/vendor/normalize-4.1.1.css" type="text/css" />
    <link rel="stylesheet" href="/vendor/border-box.css" type="text/css" />
    <link rel="stylesheet" href="/styles/layout.css" type="text/css" />

    <!-- External JS -->
    <script type="text/javascript" src="/vendor/jquery-3.0.0.js"></script>
    <script type="text/javascript" src="/scripts/app.js"></script>
    <script type="text/javascript" src="/scripts/document-ready.js"></script>
    <script type="text/javascript" src="/scripts/order-status.js"></script>
    <script type="text/javascript" src="/scripts/order-submission.js"></script>
    <script type="text/javascript" src="/scripts/sidebar.js"></script>

    <!-- Awesome Font -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" />

    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

    <title>Home Page</title>
  </head>

  <body>
    <%- include('partials/_header') %>
    <main class='order-submit-container'>
      <h3>Order Summary</h3>
      <br>
      <h4>Name: <%= results[0].user_name %></h4>
      <h5>Phone: <%= results[0].phone %></h5>
      <h5 class='order-id'>Order #<%= results[0].order_id %></h5>
      <% const event = new Date(results[0].time_placed);%>
      <% const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };%>
      <h5><%= event.toLocaleDateString(undefined, options) %></h5>
      <form class="order-submission-data" method="POST">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Item #</th>
            <th scope="col">Item Name</th>
            <th scope="col">Price</th>
            <th scope="col">Quantity</th>
            <th scope="col">Subtotal</th>
          </tr>
        </thead>
        <tbody class='table-body'>
          <% let total = 0 %>
          <% for(let i=0; i<results.length; i++) { %>
            <tr class='order-data-row'>
              <td class="order-submission-id" id="item-id-<%= i %>"><%= results[i].order_submission_id %></td>
              <td class="item-name" id="item-name-<%= i %>"><%= results[i].item_name %></td>
              <td>$<%= (results[i].price / 100).toFixed(2) %></td>
              <td>
                <div class="quantity-counter">
                  <button type="button" class="btn btn-dark button-down">-</button>
                <input type="text" class='quantity-value' value='<%= results[i].quantity %>' id='item-id-<%= i %>'>
                <button type="button" class="btn btn-dark button-up">+</button>
                </div>
              </td>
              <td>$<%= (results[i].price / 100).toFixed(2) * results[i].quantity%></td>
            </tr>
            <% total += (results[i].price / 100).toFixed(2) * results[i].quantity %>
          <% } %>
        </tbody>
      </table>
        <h3>Total Price</h3>
        <h3>$<%= total %></h3>
        <button type="submit">Confirm Order</button>
      </form>
    </main>

    <!-- Bootstrap required scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js" integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous"></script>
  </body>
</html>

